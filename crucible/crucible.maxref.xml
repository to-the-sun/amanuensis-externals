<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<c74object name="crucible">
	<digest>Selectively updates a dictionary by comparing incoming spans.</digest>
	<description>
		The `crucible` object implements a challenger/incumbent system for updating a dictionary. It receives streams of messages from an object like `buildspans`, representing musical spans, and temporarily stores them as a "challenger" span. When a complete span is received, it compares the `rating` of each bar in the challenger span to the corresponding bar in a designated "incumbent" dictionary. The challenger's data will only overwrite the incumbent's and be sent to the outlets if every one of its bar ratings is strictly higher than the incumbent's. If a bar exists in the challenger but not the incumbent, the challenger automatically wins the comparison for that bar.
	</description>

	<!-- Arguments -->
	<objarg name="incumbent_dictionary_name" type="symbol" optional="0">
		<digest>The name of the dictionary to use as the incumbent.</digest>
		<description>The first argument must be the name of a `dict` object that will serve as the incumbent dictionary for comparisons.</description>
	</objarg>

	<!-- Attributes -->
	<attribute name="verbose" type="int" optional="1" size="1">
		<digest>Enable verbose logging.</digest>
		<description>When set to 1, a rightmost outlet is created for verbose logging messages, which can be helpful for debugging.</description>
	</attribute>

	<!-- Inlets -->
	<inlet name="in" type="anything">
		<digest>Input for the message stream from buildspans.</digest>
		<description>The main inlet for receiving messages to trigger the object's parsing and comparison functionality.</description>
	</inlet>
	<inlet name="in" type="int">
		<digest>Sets the bar length.</digest>
		<description>Receives an integer that sets the `bar_length` in milliseconds. This value is used to calculate the "reach" output for winning spans.</description>
	</inlet>

	<!-- Outlets -->
	<outlet name="out" type="int">
		<digest>Reach value.</digest>
		<description>For a winning span, outputs the "reach," calculated as the largest bar timestamp in the span plus the current `bar_length`.</description>
	</outlet>
	<outlet name="out" type="symbol">
		<digest>Palette value.</digest>
		<description>For a winning span, outputs the value associated with the `palette` key.</description>
	</outlet>
	<outlet name="out" type="int">
		<digest>Bar value.</digest>
		<description>For a winning span, this outlet outputs the `bar` part of the selector as an integer for each bar in the span.</description>
	</outlet>
	<outlet name="out" type="int">
		<digest>Offset value.</digest>
		<description>For a winning span, outputs the value associated with the `offset` key.</description>
	</outlet>
</c74object>

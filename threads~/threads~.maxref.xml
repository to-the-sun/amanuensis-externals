<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet devhelp="true" type="text/xsl" href="pb-patcher.xsl"?>
<c74object name="threads~" module="msp" category="Utility">
	<digest>Writes incoming track data into a polybuffer~</digest>
	<description>
		The `threads~` object receives 4-item lists (palette, track, bar, offset) and writes them into a named `polybuffer~`. It uses a palette-to-channel mapping to determine which channel of a buffer to write to. Special values like 0 and -999999 are handled according to a specific multi-channel writing protocol. It also monitors an incoming time ramp signal on Inlet 1, triggering dictionary-driven writes on integer crossings and ramp wrap-arounds.
	</description>
	<!--METADATA-->
	<metadatalist>
		<metadata name="author">Jules</metadata>
		<metadata name="tag">Utility</metadata>
	</metadatalist>
	<!--INLETS-->
	<inletlist>
		<inlet id="1" type="signal/list">
			<digest>Inlet 1: Time ramp (signal) or Data List [palette, track, bar, offset]</digest>
			<description>Accepts an audio signal (treated as a time ramp in milliseconds) or the 4-item list from crucible or a similar source. Integer crossings and ramp wrap-arounds (delta &lt; 0) trigger dictionary lookups.</description>
		</inlet>
		<inlet id="2" type="symbol">
			<digest>Inlet 2: Rescript/Reference dictionary name</digest>
			<description>Accepts a symbol denoting an external dict to reference.</description>
		</inlet>
		<inlet id="3" type="list">
			<digest>Inlet 3: Palette Configuration</digest>
			<description>Accepts [palette_name, channel_index] pairs to register palettes.</description>
		</inlet>
	</inletlist>
	<!--OUTLETS-->
	<outletlist>
		<outlet id="1" type="signal">
			<digest>Outlet 1: Scan Head Position (ms)</digest>
			<description>Outputs the current position of the 9ms lookahead scan head in milliseconds.</description>
		</outlet>
		<outlet id="2" type="anything">
			<digest>Outlet 2: Verbose Logging Outlet</digest>
			<description>Outputs diagnostic information when the verbose attribute is enabled.</description>
		</outlet>
	</outletlist>
	<!--ARGUMENTS-->
	<objarglist>
		<objarg name="polybuffer_prefix" type="symbol" optional="0">
			<digest>Prefix for the polybuffer~ members</digest>
		</objarg>
		<objarg name="tracks" type="int" optional="1">
			<digest>Number of tracks to process</digest>
		</objarg>
	</objarglist>
	<!--MESSAGES-->
	<methodlist>
		<method name="list">
			<digest>Process data list</digest>
		</method>
		<method name="clear_visualizer">
			<digest>Clear the visualizer without clearing the buffers</digest>
			<description>Sends a clear command to the connected visualization script, but does not modify any sample data in the polybuffer~.</description>
		</method>
		<method name="dsp64">
			<digest>DSP method</digest>
		</method>
	</methodlist>
	<!--ATTRIBUTES-->
	<attributelist>
		<attribute name="verbose" type="long" get="1" set="1" opaque="0">
			<digest>Enable Verbose Logging</digest>
			<attributelist>
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="onoff" />
			</attributelist>
		</attribute>
		<attribute name="tracks" type="long" get="1" set="1" opaque="0">
			<digest>Number of Tracks</digest>
		</attribute>
	</attributelist>
	<!--SEEALSO-->
	<seealsolist>
		<seealso name="crucible" />
		<seealso name="buildspans" />
	</seealsolist>
</c74object>

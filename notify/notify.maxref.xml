<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet devhelp="true" type="text/xsl" href="pb-patcher.xsl"?>
<c74object name="notify" module="max" category="Utility">
	<digest>A high-performance dictionary-to-list converter for track and note sequencing</digest>
	<description>
		The `notify` object is a specialized utility designed to parse and output sequencing data from a named Max dictionary. It is optimized for a specific hierarchical data structure: Tracks containing Bars, which in turn contain Palette names, Offsets, and arrays of Absolute Timestamps and Scores.

		The object provides two primary modes of operation:
		1. **Standard Dump (bang)**: Iterates through all tracks and bars, collecting every note and sorting them into a single, chronologically ordered sequence by their absolute timestamps. After the dump, the source dictionary is automatically cleared.
		2. **Synthesized Fill (fill)**: Analyzes all tracks to find the "global reach" (the maximum timestamp). It then "grows" shorter tracks by looping their content until they match the global reach, ensuring all tracks have a consistent duration for playback or visualization.
	</description>
	<!--METADATA-->
	<metadatalist>
		<metadata name="author">Jules</metadata>
		<metadata name="tag">Utility</metadata>
		<metadata name="tag">Sequencing</metadata>
		<metadata name="tag">Dictionary</metadata>
	</metadatalist>
	<!--INLETS-->
	<inletlist>
		<inlet id="1" type="bang/fill">
			<digest>Control inlet for triggering data dumps</digest>
			<description>
				- **bang**: Triggers a standard dump of the bound dictionary. Notes from all tracks are aggregated, sorted by absolute timestamp, and output sequentially. The dictionary is cleared upon completion.
				- **fill**: Triggers a synthesized dump. This mode identifies the longest track and extends all other tracks to match its length by repeating their existing notes. Notes are sorted by their synthesized absolute timestamps.
			</description>
		</inlet>
		<inlet id="2" type="float">
			<digest>Local Bar Length Override</digest>
			<description>
				Accepts a float to set a manual `local_bar_length` in milliseconds. When greater than zero, this value overrides any bar length information that would otherwise be read from the `bar` buffer~. This affects how track boundaries and "caps" are calculated internally.
			</description>
		</inlet>
	</inletlist>
	<!--OUTLETS-->
	<outletlist>
		<outlet id="1" type="list">
			<digest>Outlet 1: Sorted Note Data</digest>
			<description>
				Outputs a list containing [**synthesized_absolute_ms**, **score**, **original_absolute_ms**].
				- In `bang` mode, synthesized and original timestamps are identical.
				- In `fill` mode, the synthesized timestamp reflects the note's position within the extended duration.
			</description>
		</outlet>
		<outlet id="2" type="float">
			<digest>Outlet 2: Note Offset</digest>
			<description>Outputs the offset value (in milliseconds) associated with the bar containing the current note.</description>
		</outlet>
		<outlet id="3" type="int">
			<digest>Outlet 3: Track ID</digest>
			<description>Outputs the integer ID of the track the current note belongs to.</description>
		</outlet>
		<outlet id="4" type="symbol">
			<digest>Outlet 4: Palette Name</digest>
			<description>Outputs the symbolic name of the palette associated with the current note's bar.</description>
		</outlet>
		<outlet id="5" type="anything">
			<digest>Outlet 5: Logging and Status</digest>
			<description>
				When the `@log` attribute is enabled, this outlet provides detailed verbose information about the processing steps, including track analysis, note duplication during `fill`, and binding status for external references.
			</description>
		</outlet>
	</outletlist>
	<!--ARGUMENTS-->
	<objarglist>
		<objarg name="dictionary-name" type="symbol" optional="1">
			<digest>The name of the Max dictionary to be monitored and parsed</digest>
			<description>The object will attempt to bind to a registered dictionary with this name. If no name is provided at instantiation, it can be set via attributes or by using a `dict` message (if supported by standard dictionary objects).</description>
		</objarg>
	</objarglist>
	<!--MESSAGES-->
	<methodlist>
		<method name="bang">
			<digest>Execute a standard dictionary dump</digest>
			<description>Reads all note data, sorts it chronologically, outputs it through the primary outlets, and clears the source dictionary.</description>
		</method>
		<method name="fill">
			<digest>Execute a synthesized 'filling' dump</digest>
			<description>Synchronizes track lengths by looping notes to match the longest track's reach, then outputs the aggregated result sorted by time.</description>
		</method>
		<method name="ft1">
			<digest>Set local bar length (Inlet 2)</digest>
			<description>Sets the `local_bar_length` attribute via a float message sent to the second inlet. A value of 0 or less resets the override, causing the object to look for the `bar` buffer~ instead.</description>
		</method>
	</methodlist>
	<!--ATTRIBUTES-->
	<attributelist>
		<attribute name="log" get="1" set="1" type="long" size="1">
			<digest>Enable Verbose Console and Outlet Logging</digest>
			<description>
				When enabled (1), the object will output internal status messages to the logging outlet and the Max console. This is useful for debugging dictionary structures and verifying the 'fill' logic.
			</description>
			<attributelist>
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="onoff" />
			</attributelist>
		</attribute>
	</attributelist>
	<!--SEEALSO-->
	<seealsolist>
		<seealso name="buildspans" />
		<seealso name="crucible" />
		<seealso name="threads~" />
		<seealso name="weaver~" />
		<seealso name="bounce~" />
		<seealso name="growbuffer~" />
	</seealsolist>
</c74object>
